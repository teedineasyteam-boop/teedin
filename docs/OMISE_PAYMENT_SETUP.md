# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Omise Payment (‡∏â‡∏ö‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Omise Payment ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡πÄ‡∏à‡∏ô‡∏ï‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ Teedin Easy

## üîß ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°

- ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Omise ‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏£‡∏¥‡∏á
- ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå Supabase ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á `property_payments` ‡πÅ‡∏•‡πâ‡∏ß
- ‡πÅ‡∏≠‡∏õ Next.js (App Router) ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ

---

## 1Ô∏è‚É£ ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° (Environment Variables)

### Development (`.env.local`)

```env
# Omise Test Keys
NEXT_PUBLIC_OMISE_PUBLIC_KEY=pk_test_xxxxx
OMISE_SECRET_KEY=sk_test_xxxxx
OMISE_WEBHOOK_SECRET=whsec_xxxxx

# ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡∏ö‡∏≤‡∏ó)
NEXT_PUBLIC_CONTACT_REVEAL_PRICE=10

# Supabase
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

### Production (`.env.production`)

```env
# Omise Live Keys
NEXT_PUBLIC_OMISE_PUBLIC_KEY=pk_live_xxxxx
OMISE_SECRET_KEY=sk_live_xxxxx
OMISE_WEBHOOK_SECRET=whsec_xxxxx

# ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡∏ö‡∏≤‡∏ó)
NEXT_PUBLIC_CONTACT_REVEAL_PRICE=10

# Supabase
NEXT_PUBLIC_SUPABASE_URL=your_production_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_production_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_production_service_role_key
```

---

## 2Ô∏è‚É£ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Database

### ‡∏£‡∏±‡∏ô Migration

‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á `property_payments` ‡∏î‡πâ‡∏ß‡∏¢‡πÑ‡∏ü‡∏•‡πå `supabase-migrations/create-property-payments-table.sql`

```sql
-- ‡∏£‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô Supabase SQL Editor ‡∏´‡∏£‡∏∑‡∏≠ CLI
```

‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Supabase CLI:

```bash
supabase db push
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á

```sql
SELECT * FROM property_payments LIMIT 1;
```

---

## 3Ô∏è‚É£ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Omise Dashboard

### ‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö (Test)

1. ‡πÄ‡∏Ç‡πâ‡∏≤ [Omise Dashboard (Test)](https://dashboard.omise.co/test)
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Settings > Webhooks**
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Add new webhook**
4. ‡∏Å‡∏£‡∏≠‡∏Å URL
   - Dev ‡∏ú‡πà‡∏≤‡∏ô ngrok: `https://your-ngrok-url.ngrok-free.app/api/omise-webhook`
   - Production: `https://yourdomain.com/api/omise-webhook`
5. ‡πÄ‡∏õ‡∏¥‡∏î Events ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
   - `charge.create`
   - `charge.complete`
   - `charge.update`
6. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Webhook Signing Secret ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô `.env.local` (`OMISE_WEBHOOK_SECRET`)

### ‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏£‡∏¥‡∏á (Live)

1. ‡πÄ‡∏Ç‡πâ‡∏≤ [Omise Dashboard (Live)](https://dashboard.omise.co/live)
2. ‡∏ó‡∏≥‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö
3. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏à‡∏£‡∏¥‡∏á
4. ‡πÄ‡∏ã‡∏ü Signing Secret ‡πÑ‡∏õ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô `.env.production`

---

## 4Ô∏è‚É£ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö (Testing)

### Dev Server + ngrok

1. ‡∏£‡∏±‡∏ô Next.js dev server
   ```bash
   pnpm dev
   ```
2. ‡πÄ‡∏õ‡∏¥‡∏î ngrok ‡πÉ‡∏ô‡∏≠‡∏µ‡∏Å terminal
   ```bash
   ngrok http 3000
   ```
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Forwarding URL (‡πÄ‡∏ä‡πà‡∏ô `https://abc123.ngrok-free.app`)
4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ webhook URL ‡πÉ‡∏ô Omise ‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡πâ‡∏°‡∏≤‡∏ó‡∏µ‡πà `https://abc123.ngrok-free.app/api/omise-webhook`
5. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö
   - ‡πÉ‡∏ä‡πâ‡∏ö‡∏±‡∏ï‡∏£‡∏à‡∏≤‡∏Å https://www.omise.co/test-cards
   - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: `4242424242424242` (Visa, ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à)

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Webhook

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Omise Dashboard > Webhooks
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å webhook ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
3. ‡∏Å‡∏î **Send test event**
4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö log ‡∏ù‡∏±‡πà‡∏á Next.js ‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö event ‡πÅ‡∏•‡πâ‡∏ß

### ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á Webhook ‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß

‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô `node -e` ‡πÄ‡∏≠‡∏á:

```bash
pnpm simulate:omise-webhook --charge-id=chrg_test_xxx \
   --webhook-url=https://<ngrok>.ngrok-free.app/api/omise-webhook
```

‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:

- `OMISE_WEBHOOK_SECRET` ‡∏à‡∏≤‡∏Å `.env.local`
- `WEBHOOK_URL` ‡∏´‡∏£‡∏∑‡∏≠ `OMISE_WEBHOOK_URL` (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡πà‡∏á `--webhook-url`)
- `CHARGE_ID` (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡πà‡∏á `--charge-id`)

‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÄ‡∏ä‡πà‡∏ô `--status=failed`, `--event=charge.update`, `--timeout=15000` ‡∏´‡∏£‡∏∑‡∏≠ `--note="manual test"` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏™‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÑ‡∏î‡πâ

---

## 5Ô∏è‚É£ ‡πÄ‡∏ä‡πá‡∏Å‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏õ Production

### ‡∏Å‡πà‡∏≠‡∏ô Deploy

- [ ] ‡∏£‡∏±‡∏ô migration ‡∏ö‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
- [ ] ‡∏Å‡∏≥‡∏´‡∏ô‡∏î ENV ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Production
- [ ] ‡πÉ‡∏ä‡πâ Omise Live Keys ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ webhook URL ‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Omise
- [ ] ‡∏ó‡∏ß‡∏ô flow ‡∏î‡πâ‡∏ß‡∏¢ Test Mode ‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à

### ‡∏´‡∏•‡∏±‡∏á Deploy

- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ
  - `POST /api/omise-charge`
  - `GET /api/property-payments/access`
  - `POST /api/omise-webhook`
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á (Live Mode) ‡∏î‡πâ‡∏ß‡∏¢ PromptPay/‡∏ö‡∏±‡∏ï‡∏£‡∏à‡∏£‡∏¥‡∏á
- [ ] ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤ webhook ‡∏™‡πà‡∏á event ‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ
- [ ] ‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á `property_payments` ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

---

## 6Ô∏è‚É£ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î API

### `POST /api/omise-charge`

‡∏™‡∏£‡πâ‡∏≤‡∏á charge ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô

**Request**

```json
{
  "amount": 99,
  "propertyId": "uuid-here",
  "token": "tokn_xxxxx",
  "description": "Contact access for property"
}
```

**Response**

```json
{
  "success": true,
  "charge": { ... },
  "hasAccess": true
}
```

### `GET /api/property-payments/access?propertyId=xxx`

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏±‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á

**Response**

```json
{
  "success": true,
  "hasAccess": true,
  "paymentStatus": "successful"
}
```

### `POST /api/omise-webhook`

‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà Omise ‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ charge ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏≠‡∏á

---

## 7Ô∏è‚É£ ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

### Webhook ‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏á

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏ß‡πà‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏° ngrok ‡πÅ‡∏•‡πâ‡∏ß
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤ `OMISE_WEBHOOK_SECRET`
- ‡∏î‡∏π log ‡πÉ‡∏ô Next.js console
- ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° **Send test event** ‡∏à‡∏≤‡∏Å Omise ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏≠‡∏á‡∏¢‡∏¥‡∏á‡πÉ‡∏´‡∏°‡πà

### Payment ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

- ‡πÄ‡∏ä‡πá‡∏Å‡∏ß‡πà‡∏≤ migration ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß
- ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤ `SUPABASE_SERVICE_ROLE_KEY` ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡πÄ‡∏õ‡∏¥‡∏î log server ‡∏î‡∏π error ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

### Charge ‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà `pending`

- ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÉ‡∏ô Test Mode ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á
- ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ webhook `charge.complete` ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á event ‡πÄ‡∏≠‡∏á
- ‡∏´‡∏≤‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô Live Mode ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£/Omise dashboard ‡∏ß‡πà‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á

---

## 8Ô∏è‚É£ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

1. **‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà secret keys** ‡πÄ‡∏Å‡πá‡∏ö `OMISE_SECRET_KEY` ‡πÅ‡∏•‡∏∞ `OMISE_WEBHOOK_SECRET` ‡πÑ‡∏ß‡πâ‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á** ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ `X-Omise-Signature` ‡πÅ‡∏•‡πâ‡∏ß verify ‡∏î‡πâ‡∏ß‡∏¢ HMAC
3. **‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö HTTPS** ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô dev (‡∏ú‡πà‡∏≤‡∏ô ngrok) ‡πÅ‡∏•‡∏∞ production
4. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö session ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ** ‡∏ó‡∏∏‡∏Å endpoint ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `getUserFromRequest` ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏•‡πÑ‡∏Å auth ‡∏≠‡∏∑‡πà‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

---

## 9Ô∏è‚É£ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠

- Omise Documentation: https://docs.omise.co/
- Omise Test Cards: https://www.omise.co/test-cards
- Omise Support: support@omise.co

---

## üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

- ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Ñ‡∏∑‡∏≠ 10 ‡∏ö‡∏≤‡∏ó ‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà `NEXT_PUBLIC_CONTACT_REVEAL_PRICE`
- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á `property_payments`
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Omise ‡∏™‡πà‡∏á webhook ‡∏°‡∏≤ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ `property_payments` ‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏á

## ‚úÖ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

- pnpm simulate:omise-webhook
